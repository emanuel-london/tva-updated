!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@turf/bbox"),require("@turf/helpers"),require("mapbox-gl"),require("rxjs/AsyncSubject"),require("rxjs/operators/first"),require("rxjs/Subscription"),require("rxjs/operators/debounceTime"),require("rxjs/Subject"),require("rxjs/observable/fromEvent"),require("rxjs/operators/filter"),require("rxjs/operators/switchMap"),require("rxjs/operators/take"),require("rxjs/operators/takeUntil"),require("rxjs/operators/tap"),require("rxjs/ReplaySubject"),require("rxjs/observable/merge"),require("rxjs/operators/startWith"),require("supercluster"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-mapbox-gl",["exports","@angular/core","@turf/bbox","@turf/helpers","mapbox-gl","rxjs/AsyncSubject","rxjs/operators/first","rxjs/Subscription","rxjs/operators/debounceTime","rxjs/Subject","rxjs/observable/fromEvent","rxjs/operators/filter","rxjs/operators/switchMap","rxjs/operators/take","rxjs/operators/takeUntil","rxjs/operators/tap","rxjs/ReplaySubject","rxjs/observable/merge","rxjs/operators/startWith","supercluster","@angular/common"],e):e(t["ngx-mapbox-gl"]={},t.ng.core,t.turfbbox,t.turfhelpers,t.mapboxgl,t.Rx,t.Rx.Observable.prototype,t.Rx,t.Rx.Observable.prototype,t.Rx,t.Rx.Observable,t.Rx.Observable.prototype,t.Rx.Observable.prototype,t.Rx.Observable.prototype,t.Rx.Observable.prototype,t.Rx.Observable.prototype,t.Rx,t.Rx.Observable,t.Rx.Observable.prototype,t.supercluster,t.ng.common)}(this,function(t,r,s,u,i,o,n,a,e,p,c,m,h,l,d,y,f,g,v,b,I){"use strict";function C(e,a,s,u){return new(s||(s=Promise))(function(t,n){function o(t){try{i(u.next(t))}catch(e){n(e)}}function r(t){try{i(u["throw"](t))}catch(e){n(e)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(o,r)}i((u=u.apply(e,a||[])).next())})}function E(n,o){var r,i,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),"throw":e(1),"return":e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=o.call(n,s)}catch(e){t=[6,e],i=0}finally{r=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([e,t])}}}function O(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}s=s&&s.hasOwnProperty("default")?s["default"]:s,b=b&&b.hasOwnProperty("default")?b["default"]:b;var S=new r.InjectionToken("MapboxApiKey"),x=function(){},M=function(){function t(t,e,n){this.zone=t,this.MAPBOX_API_KEY=e,this.MglResizeEventEmitter=n,this.mapCreated=new o.AsyncSubject,this.mapLoaded=new o.AsyncSubject,this.layerIdsToRemove=[],this.sourceIdsToRemove=[],this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new a.Subscription,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}return t.prototype.setup=function(t){var e=this;this.zone.onStable.pipe(n.first()).subscribe(function(){e.assign(i,"accessToken",t.accessToken||e.MAPBOX_API_KEY),t.customMapboxApiUrl&&e.assign(i,"config.API_URL",t.customMapboxApiUrl),e.createMap(t.mapOptions),e.hookEvents(t.mapEvents),e.mapEvents=t.mapEvents,e.mapCreated.next(undefined),e.mapCreated.complete()})},t.prototype.destroyMap=function(){this.subscription.unsubscribe(),this.mapInstance.remove()},t.prototype.updateMinZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.setMinZoom(t)})},t.prototype.updateMaxZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.setMaxZoom(t)})},t.prototype.updateScrollZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.scrollZoom.enable():e.mapInstance.scrollZoom.disable()})},t.prototype.updateDragRotate=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.dragRotate.enable():e.mapInstance.dragRotate.disable()})},t.prototype.updateTouchZoomRotate=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.touchZoomRotate.enable():e.mapInstance.touchZoomRotate.disable()})},t.prototype.updateDoubleClickZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.doubleClickZoom.enable():e.mapInstance.doubleClickZoom.disable()})},t.prototype.updateKeyboard=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.keyboard.enable():e.mapInstance.keyboard.disable()})},t.prototype.updateDragPan=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.dragPan.enable():e.mapInstance.dragPan.disable()})},t.prototype.updateBoxZoom=function(t){var e=this;return this.zone.runOutsideAngular(function(){t?e.mapInstance.boxZoom.enable():e.mapInstance.boxZoom.disable()})},t.prototype.updateStyle=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.setStyle(t)})},t.prototype.updateMaxBounds=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.setMaxBounds(t)})},t.prototype.changeCanvasCursor=function(t){this.mapInstance.getCanvasContainer().style.cursor=t},t.prototype.queryRenderedFeatures=function(t,e){return this.mapInstance.queryRenderedFeatures(t,e)},t.prototype.panTo=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){n.mapInstance.panTo(t,e)})},t.prototype.move=function(t,e,n,o,r,i){var a=this;return this.zone.runOutsideAngular(function(){a.mapInstance[t](Object.assign({},e,{zoom:n||a.mapInstance.getZoom(),center:o||a.mapInstance.getCenter(),bearing:r||a.mapInstance.getBearing(),pitch:i||a.mapInstance.getPitch()}))})},t.prototype.addLayer=function(n,t){var e=this;this.zone.runOutsideAngular(function(){Object.keys(n.layerOptions).forEach(function(t){var e=t;n.layerOptions[e]===undefined&&delete n.layerOptions[e]}),e.mapInstance.addLayer(n.layerOptions,t),n.layerEvents.click.observers.length&&e.mapInstance.on("click",n.layerOptions.id,function(t){e.zone.run(function(){n.layerEvents.click.emit(t)})}),n.layerEvents.mouseEnter.observers.length&&e.mapInstance.on("mouseenter",n.layerOptions.id,function(t){e.zone.run(function(){n.layerEvents.mouseEnter.emit(t)})}),n.layerEvents.mouseLeave.observers.length&&e.mapInstance.on("mouseleave",n.layerOptions.id,function(t){e.zone.run(function(){n.layerEvents.mouseLeave.emit(t)})}),n.layerEvents.mouseMove.observers.length&&e.mapInstance.on("mousemove",n.layerOptions.id,function(t){e.zone.run(function(){n.layerEvents.mouseMove.emit(t)})})})},t.prototype.removeLayer=function(t){this.layerIdsToRemove.push(t)},t.prototype.addMarker=function(t){var e=this;return this.zone.runOutsideAngular(function(){t.addTo(e.mapInstance)})},t.prototype.removeMarker=function(t){this.markersToRemove.push(t)},t.prototype.addPopup=function(t){var e=this;return this.zone.runOutsideAngular(function(){t.addTo(e.mapInstance)})},t.prototype.removePopup=function(t){this.popupsToRemove.push(t)},t.prototype.addControl=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){n.mapInstance.addControl(t,e)})},t.prototype.removeControl=function(t){var e=this;return this.zone.runOutsideAngular(function(){e.mapInstance.removeControl(t)})},t.prototype.loadAndAddImage=function(i,e,a){return C(this,void 0,void 0,function(){var r=this;return E(this,function(t){return[2,this.zone.runOutsideAngular(function(){return new Promise(function(n,o){r.mapInstance.loadImage(e,function(t,e){t?o(t):(r.addImage(i,e,a),n())})})})]})})},t.prototype.addImage=function(t,e,n){var o=this;return this.zone.runOutsideAngular(function(){o.mapInstance.addImage(t,e,n)})},t.prototype.removeImage=function(t){this.imageIdsToRemove.push(t)},t.prototype.addSource=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){Object.keys(e).forEach(function(t){return e[t]===undefined&&delete e[t]}),n.mapInstance.addSource(t,e)})},t.prototype.getSource=function(t){return this.mapInstance.getSource(t)},t.prototype.removeSource=function(t){this.sourceIdsToRemove.push(t)},t.prototype.setAllLayerPaintProperty=function(e,n){var o=this;return this.zone.runOutsideAngular(function(){Object.keys(n).forEach(function(t){o.mapInstance.setPaintProperty(e,t,n[t])})})},t.prototype.setAllLayerLayoutProperty=function(e,n){var o=this;return this.zone.runOutsideAngular(function(){Object.keys(n).forEach(function(t){o.mapInstance.setLayoutProperty(e,t,n[t])})})},t.prototype.setLayerFilter=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){n.mapInstance.setFilter(t,e)})},t.prototype.setLayerBefore=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){n.mapInstance.moveLayer(t,e)})},t.prototype.setLayerZoomRange=function(t,e,n){var o=this;return this.zone.runOutsideAngular(function(){o.mapInstance.setLayerZoomRange(t,e||0,n||20)})},t.prototype.fitBounds=function(t,e){var n=this;return this.zone.runOutsideAngular(function(){n.mapInstance.fitBounds(t,e)})},t.prototype.getCurrentViewportBbox=function(){var t=this.mapInstance.getCanvas(),e=t.width,n=t.height,o=this.mapInstance.unproject([0,0]).toArray(),r=this.mapInstance.unproject([e,0]).toArray(),i=this.mapInstance.unproject([e,n]).toArray(),a=this.mapInstance.unproject([0,n]).toArray();return s(u.polygon([[o,r,i,a,o]]))},t.prototype.applyChanges=function(){var t=this;this.zone.runOutsideAngular(function(){t.removeLayers(),t.removeSources(),t.removeMarkers(),t.removePopups(),t.removeImages()})},t.prototype.createMap=function(n){var t=this;r.NgZone.assertNotInAngularZone(),Object.keys(n).forEach(function(t){var e=t;n[e]===undefined&&delete n[e]}),this.mapInstance=new i.Map(n);var e=this.zone.onMicrotaskEmpty.subscribe(function(){return t.applyChanges()});if(this.MglResizeEventEmitter){var o=this.MglResizeEventEmitter.resizeEvent.subscribe(function(){t.mapInstance.resize()});this.subscription.add(o)}this.subscription.add(e)},t.prototype.removeLayers=function(){try{for(var t=O(this.layerIdsToRemove),e=t.next();!e.done;e=t.next()){var n=e.value;this.mapInstance.off("click",n),this.mapInstance.off("mouseenter",n),this.mapInstance.off("mouseleave",n),this.mapInstance.off("mousemove",n),this.mapInstance.removeLayer(n)}}catch(i){o={error:i}}finally{try{e&&!e.done&&(r=t["return"])&&r.call(t)}finally{if(o)throw o.error}}var o,r;this.layerIdsToRemove=[]},t.prototype.removeSources=function(){try{for(var t=O(this.sourceIdsToRemove),e=t.next();!e.done;e=t.next()){var n=e.value;this.mapInstance.removeSource(n)}}catch(i){o={error:i}}finally{try{e&&!e.done&&(r=t["return"])&&r.call(t)}finally{if(o)throw o.error}}var o,r;this.sourceIdsToRemove=[]},t.prototype.removeMarkers=function(){try{for(var t=O(this.markersToRemove),e=t.next();!e.done;e=t.next()){e.value.remove()}}catch(r){n={error:r}}finally{try{e&&!e.done&&(o=t["return"])&&o.call(t)}finally{if(n)throw n.error}}var n,o;this.markersToRemove=[]},t.prototype.removePopups=function(){try{for(var t=O(this.popupsToRemove),e=t.next();!e.done;e=t.next()){e.value.remove()}}catch(r){n={error:r}}finally{try{e&&!e.done&&(o=t["return"])&&o.call(t)}finally{if(n)throw n.error}}var n,o;this.popupsToRemove=[]},t.prototype.removeImages=function(){try{for(var t=O(this.imageIdsToRemove),e=t.next();!e.done;e=t.next()){var n=e.value;this.mapInstance.removeImage(n)}}catch(i){o={error:i}}finally{try{e&&!e.done&&(r=t["return"])&&r.call(t)}finally{if(o)throw o.error}}var o,r;this.imageIdsToRemove=[]},t.prototype.hookEvents=function(e){var n=this;this.mapInstance.on("load",function(){n.mapLoaded.next(undefined),n.mapLoaded.complete(),n.zone.run(function(){return e.load.emit(n.mapInstance)})}),e.resize.observers.length&&this.mapInstance.on("resize",function(){return n.zone.run(function(){return e.resize.emit()})}),e.remove.observers.length&&this.mapInstance.on("remove",function(){return n.zone.run(function(){return e.remove.emit()})}),e.mouseDown.observers.length&&this.mapInstance.on("mousedown",function(t){return n.zone.run(function(){return e.mouseDown.emit(t)})}),e.mouseUp.observers.length&&this.mapInstance.on("mouseup",function(t){return n.zone.run(function(){return e.mouseUp.emit(t)})}),e.mouseMove.observers.length&&this.mapInstance.on("mousemove",function(t){return n.zone.run(function(){return e.mouseMove.emit(t)})}),e.click.observers.length&&this.mapInstance.on("click",function(t){return n.zone.run(function(){return e.click.emit(t)})}),e.dblClick.observers.length&&this.mapInstance.on("dblclick",function(t){return n.zone.run(function(){return e.dblClick.emit(t)})}),e.mouseEnter.observers.length&&this.mapInstance.on("mouseenter",function(t){return n.zone.run(function(){return e.mouseEnter.emit(t)})}),e.mouseLeave.observers.length&&this.mapInstance.on("mouseleave",function(t){return n.zone.run(function(){return e.mouseLeave.emit(t)})}),e.mouseOver.observers.length&&this.mapInstance.on("mouseover",function(t){return n.zone.run(function(){return e.mouseOver.emit(t)})}),e.mouseOut.observers.length&&this.mapInstance.on("mouseout",function(t){return n.zone.run(function(){return e.mouseOut.emit(t)})}),e.contextMenu.observers.length&&this.mapInstance.on("contextmenu",function(t){return n.zone.run(function(){return e.contextMenu.emit(t)})}),e.touchStart.observers.length&&this.mapInstance.on("touchstart",function(t){return n.zone.run(function(){return e.touchStart.emit(t)})}),e.touchEnd.observers.length&&this.mapInstance.on("touchend",function(t){return n.zone.run(function(){return e.touchEnd.emit(t)})}),e.touchMove.observers.length&&this.mapInstance.on("touchmove",function(t){return n.zone.run(function(){return e.touchMove.emit(t)})}),e.touchCancel.observers.length&&this.mapInstance.on("touchcancel",function(t){return n.zone.run(function(){return e.touchCancel.emit(t)})}),e.moveStart.observers.length&&this.mapInstance.on("movestart",function(t){return n.zone.run(function(){return e.moveStart.emit(t)})}),e.move.observers.length&&this.mapInstance.on("move",function(t){return n.zone.run(function(){return e.move.emit(t)})}),e.moveEnd.observers.length&&this.mapInstance.on("moveend",function(t){return n.zone.run(function(){return e.moveEnd.emit(t)})}),e.dragStart.observers.length&&this.mapInstance.on("dragstart",function(t){return n.zone.run(function(){return e.dragStart.emit(t)})}),e.drag.observers.length&&this.mapInstance.on("drag",function(t){return n.zone.run(function(){return e.drag.emit(t)})}),e.dragEnd.observers.length&&this.mapInstance.on("dragend",function(t){return n.zone.run(function(){return e.dragEnd.emit(t)})}),e.zoomStart.observers.length&&this.mapInstance.on("zoomstart",function(t){return n.zone.run(function(){return e.zoomStart.emit(t)})}),e.zoomEvt.observers.length&&this.mapInstance.on("zoom",function(t){return n.zone.run(function(){return e.zoomEvt.emit(t)})}),e.zoomEnd.observers.length&&this.mapInstance.on("zoomend",function(t){return n.zone.run(function(){return e.zoomEnd.emit(t)})}),e.rotateStart.observers.length&&this.mapInstance.on("rotatestart",function(t){return n.zone.run(function(){return e.rotateStart.emit(t)})}),e.rotate.observers.length&&this.mapInstance.on("rotate",function(t){return n.zone.run(function(){return e.rotate.emit(t)})}),e.rotateEnd.observers.length&&this.mapInstance.on("rotateend",function(t){return n.zone.run(function(){return e.rotateEnd.emit(t)})}),e.pitchStart.observers.length&&this.mapInstance.on("pitchstart",function(t){return n.zone.run(function(){return e.pitchStart.emit(t)})}),e.pitchEvt.observers.length&&this.mapInstance.on("pitch",function(t){return n.zone.run(function(){return e.pitchEvt.emit(t)})}),e.pitchEnd.observers.length&&this.mapInstance.on("pitchend",function(t){return n.zone.run(function(){return e.pitchEnd.emit(t)})}),e.boxZoomStart.observers.length&&this.mapInstance.on("boxzoomstart",function(t){return n.zone.run(function(){return e.boxZoomStart.emit(t)})}),e.boxZoomEnd.observers.length&&this.mapInstance.on("boxzoomend",function(t){return n.zone.run(function(){return e.boxZoomEnd.emit(t)})}),e.boxZoomCancel.observers.length&&this.mapInstance.on("boxzoomcancel",function(t){return n.zone.run(function(){return e.boxZoomCancel.emit(t)})}),e.webGlContextLost.observers.length&&this.mapInstance.on("webglcontextlost",function(){return n.zone.run(function(){return e.webGlContextLost.emit()})}),e.webGlContextRestored.observers.length&&this.mapInstance.on("webglcontextrestored",function(){return n.zone.run(function(){return e.webGlContextRestored.emit()})}),e.render.observers.length&&this.mapInstance.on("render",function(){return n.zone.run(function(){return e.render.emit()})}),e.error.observers.length&&this.mapInstance.on("error",function(){return n.zone.run(function(){return e.error.emit()})}),e.data.observers.length&&this.mapInstance.on("data",function(t){return n.zone.run(function(){return e.data.emit(t)})}),e.styleData.observers.length&&this.mapInstance.on("styledata",function(t){return n.zone.run(function(){return e.styleData.emit(t)})}),e.sourceData.observers.length&&this.mapInstance.on("sourcedata",function(t){return n.zone.run(function(){return e.sourceData.emit(t)})}),e.dataLoading.observers.length&&this.mapInstance.on("dataloading",function(t){return n.zone.run(function(){return e.dataLoading.emit(t)})}),e.styleDataLoading.observers.length&&this.mapInstance.on("styledataloading",function(t){return n.zone.run(function(){return e.styleDataLoading.emit(t)})}),e.sourceDataLoading.observers.length&&this.mapInstance.on("sourcedataloading",function(t){return n.zone.run(function(){return e.sourceDataLoading.emit(t)})})},t.prototype.assign=function(t,e,n){if("string"==typeof e&&(e=e.split(".")),1<e.length){var o=e.shift();this.assign(t[o]="[object Object]"===Object.prototype.toString.call(t[o])?t[o]:{},e,n)}else t[e[0]]=n},t}();M.decorators=[{type:r.Injectable}],M.ctorParameters=function(){return[{type:r.NgZone},{type:undefined,decorators:[{type:r.Optional},{type:r.Inject,args:[S]}]},{type:x,decorators:[{type:r.Optional}]}]};var z=function(){function t(t){this.container=t}return t.prototype.onAdd=function(){return this.container},t.prototype.onRemove=function(){return this.container.parentNode.removeChild(this.container)},t.prototype.getDefaultPosition=function(){return"top-right"},t}(),w=function(){function t(t){this.MapService=t}return t.prototype.ngAfterContentInit=function(){var t=this;this.content.nativeElement.childNodes.length&&(this.control=new z(this.content.nativeElement),this.MapService.mapCreated$.subscribe(function(){t.MapService.addControl(t.control,t.position)}))},t.prototype.ngOnDestroy=function(){this.MapService.removeControl(this.control)},t}();w.decorators=[{type:r.Component,args:[{selector:"mgl-control",template:'<div class="mapboxgl-ctrl" #content><ng-content></ng-content></div>',changeDetection:r.ChangeDetectionStrategy.OnPush}]}],w.ctorParameters=function(){return[{type:M}]},w.propDecorators={position:[{type:r.Input}],content:[{type:r.ViewChild,args:["content"]}]};var k=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var e=this;this.MapService.mapCreated$.subscribe(function(){if(e.ControlComponent.control)throw new Error("Another control is already set for this control");var t={};e.compact!==undefined&&(t.compact=e.compact),e.ControlComponent.control=new i.AttributionControl(t),e.MapService.addControl(e.ControlComponent.control,e.ControlComponent.position)})},t}();k.decorators=[{type:r.Directive,args:[{selector:"[mglAttribution]"}]}],k.ctorParameters=function(){return[{type:M},{type:w,decorators:[{type:r.Host}]}]},k.propDecorators={compact:[{type:r.Input}]};var D=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");t.ControlComponent.control=new i.FullscreenControl,t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)})},t}();D.decorators=[{type:r.Directive,args:[{selector:"[mglFullscreen]"}]}],D.ctorParameters=function(){return[{type:M},{type:w,decorators:[{type:r.Host}]}]};var A=require("@mapbox/mapbox-gl-geocoder"),P=new r.InjectionToken("MapboxApiKey"),L=function(){function t(t,e,n,o){this.MapService=t,this.zone=e,this.ControlComponent=n,this.MAPBOX_GEOCODER_API_KEY=o,this.clear=new r.EventEmitter,this.loading=new r.EventEmitter,this.results=new r.EventEmitter,this.result=new r.EventEmitter,this.error=new r.EventEmitter}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var n={proximity:t.proximity,country:t.country,placeholder:t.placeholder,zoom:t.zoom,bbox:t.bbox,types:t.types,flyTo:t.flyTo,minLength:t.minLength,limit:t.limit,language:t.language,filter:t.filter,localGeocoder:t.localGeocoder,accessToken:t.accessToken||t.MAPBOX_GEOCODER_API_KEY};Object.keys(n).forEach(function(t){var e=t;n[e]===undefined&&delete n[e]}),t.geocoder=new A(n),t.hookEvents(t),t.addControl()})},t.prototype.ngOnChanges=function(t){t.proximity&&!t.proximity.isFirstChange()&&this.geocoder.setProximity(t.proximity.currentValue)},t.prototype.addControl=function(){this.ControlComponent.control=this.geocoder,this.MapService.addControl(this.ControlComponent.control,this.ControlComponent.position)},t.prototype.hookEvents=function(e){var n=this;e.results.observers.length&&this.geocoder.on("results",function(t){return n.zone.run(function(){return e.results.emit(t)})}),e.result.observers.length&&this.geocoder.on("result",function(t){return n.zone.run(function(){return e.result.emit(t)})}),e.error.observers.length&&this.geocoder.on("error",function(t){return n.zone.run(function(){return e.error.emit(t)})}),e.loading.observers.length&&this.geocoder.on("loading",function(t){return n.zone.run(function(){return e.loading.emit(t)})}),e.clear.observers.length&&this.geocoder.on("clear",function(){return n.zone.run(function(){return e.clear.emit()})})},t}();L.decorators=[{type:r.Directive,args:[{selector:"[mglGeocoder]"}]}],L.ctorParameters=function(){return[{type:M},{type:r.NgZone},{type:w,decorators:[{type:r.Host}]},{type:undefined,decorators:[{type:r.Optional},{type:r.Inject,args:[P]}]}]},L.propDecorators={country:[{type:r.Input}],placeholder:[{type:r.Input}],zoom:[{type:r.Input}],bbox:[{type:r.Input}],types:[{type:r.Input}],flyTo:[{type:r.Input}],minLength:[{type:r.Input}],limit:[{type:r.Input}],language:[{type:r.Input}],accessToken:[{type:r.Input}],filter:[{type:r.Input}],localGeocoder:[{type:r.Input}],proximity:[{type:r.Input}],clear:[{type:r.Output}],loading:[{type:r.Output}],results:[{type:r.Output}],result:[{type:r.Output}],error:[{type:r.Output}]};var F=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var n={positionOptions:t.positionOptions,fitBoundsOptions:t.fitBoundsOptions,trackUserLocation:t.trackUserLocation,showUserLocation:t.showUserLocation};Object.keys(n).forEach(function(t){var e=t;n[e]===undefined&&delete n[e]}),t.ControlComponent.control=new i.GeolocateControl(n),t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)})},t}();F.decorators=[{type:r.Directive,args:[{selector:"[mglGeolocate]"}]}],F.ctorParameters=function(){return[{type:M},{type:w,decorators:[{type:r.Host}]}]},F.propDecorators={positionOptions:[{type:r.Input}],fitBoundsOptions:[{type:r.Input}],trackUserLocation:[{type:r.Input}],showUserLocation:[{type:r.Input}]};var Z=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapCreated$.subscribe(function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");t.ControlComponent.control=new i.NavigationControl,t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)})},t}();Z.decorators=[{type:r.Directive,args:[{selector:"[mglNavigation]"}]}],Z.ctorParameters=function(){return[{type:M},{type:w,decorators:[{type:r.Host}]}]};var R=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnInit=function(){var e=this;this.MapService.mapCreated$.subscribe(function(){if(e.ControlComponent.control)throw new Error("Another control is already set for this control");var t={};e.maxWidth!==undefined&&(t.maxWidth=e.maxWidth),e.unit!==undefined&&(t.unit=e.unit),e.ControlComponent.control=new i.ScaleControl(t),e.MapService.addControl(e.ControlComponent.control,e.ControlComponent.position)})},t}();R.decorators=[{type:r.Directive,args:[{selector:"[mglScale]"}]}],R.ctorParameters=function(){return[{type:M},{type:w,decorators:[{type:r.Host}]}]},R.propDecorators={maxWidth:[{type:r.Input}],unit:[{type:r.Input}]};var j=function(){function t(t){this.MapService=t,this.click=new r.EventEmitter,this.mouseEnter=new r.EventEmitter,this.mouseLeave=new r.EventEmitter,this.mouseMove=new r.EventEmitter,this.layerAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){t.MapService.addLayer({layerOptions:{id:t.id,type:t.type,source:t.source,metadata:t.metadata,"source-layer":t.sourceLayer,minzoom:t.minzoom,maxzoom:t.maxzoom,filter:t.filter,layout:t.layout,paint:t.paint},layerEvents:{click:t.click,mouseEnter:t.mouseEnter,mouseLeave:t.mouseLeave,mouseMove:t.mouseMove}},t.before),t.layerAdded=!0})},t.prototype.ngOnChanges=function(t){this.layerAdded&&(t.paint&&!t.paint.isFirstChange()&&this.MapService.setAllLayerPaintProperty(this.id,t.paint.currentValue),t.layout&&!t.layout.isFirstChange()&&this.MapService.setAllLayerLayoutProperty(this.id,t.layout.currentValue),t.filter&&!t.filter.isFirstChange()&&this.MapService.setLayerFilter(this.id,t.filter.currentValue),t.before&&!t.before.isFirstChange()&&this.MapService.setLayerBefore(this.id,t.before.currentValue),(t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange())&&this.MapService.setLayerZoomRange(this.id,this.minzoom,this.maxzoom))},t.prototype.ngOnDestroy=function(){this.layerAdded&&this.MapService.removeLayer(this.id)},t}();j.decorators=[{type:r.Component,args:[{selector:"mgl-layer",template:""}]}],j.ctorParameters=function(){return[{type:M}]},j.propDecorators={id:[{type:r.Input}],source:[{type:r.Input}],type:[{type:r.Input}],metadata:[{type:r.Input}],sourceLayer:[{type:r.Input}],filter:[{type:r.Input}],layout:[{type:r.Input}],paint:[{type:r.Input}],before:[{type:r.Input}],minzoom:[{type:r.Input}],maxzoom:[{type:r.Input}],click:[{type:r.Output}],mouseEnter:[{type:r.Output}],mouseLeave:[{type:r.Output}],mouseMove:[{type:r.Output}]};var T=function(){function t(t){this.MapService=t}return t.prototype.ngOnInit=function(){if(this.feature&&this.lngLat)throw new Error("feature and lngLat input are mutually exclusive")},t.prototype.ngOnChanges=function(t){t.lngLat&&!t.lngLat.isFirstChange()&&this.markerInstance.setLngLat(this.lngLat),t.feature&&!t.feature.isFirstChange()&&this.markerInstance.setLngLat(this.feature.geometry.coordinates)},t.prototype.ngAfterViewInit=function(){var t=this;this.markerInstance=new i.Marker(this.content.nativeElement,{offset:this.offset}),this.markerInstance.setLngLat(this.feature?this.feature.geometry.coordinates:this.lngLat),this.MapService.mapCreated$.subscribe(function(){t.MapService.addMarker(t.markerInstance)})},t.prototype.ngOnDestroy=function(){this.MapService.removeMarker(this.markerInstance),this.markerInstance=undefined},t.prototype.togglePopup=function(){this.markerInstance.togglePopup()},t.prototype.updateCoordinates=function(t){this.markerInstance.setLngLat(t)},t}();T.decorators=[{type:r.Component,args:[{selector:"mgl-marker",template:"<div #content><ng-content></ng-content></div>",styles:["\n    .mapboxgl-marker {\n      line-height: 0;\n    }\n  "],encapsulation:r.ViewEncapsulation.None,changeDetection:r.ChangeDetectionStrategy.OnPush}]}],T.ctorParameters=function(){return[{type:M}]},T.propDecorators={offset:[{type:r.Input}],feature:[{type:r.Input}],lngLat:[{type:r.Input}],content:[{type:r.ViewChild,args:["content"]}]};var B=function(){function t(t){this.MapService=t,this.updateFeatureData=new p.Subject,this.sourceAdded=!1,this.featureIdCounter=0}return t.prototype.ngOnInit=function(){var t=this;this.data||(this.data={type:"FeatureCollection",features:[]}),this.MapService.mapLoaded$.subscribe(function(){t.MapService.addSource(t.id,{type:"geojson",data:t.data,maxzoom:t.maxzoom,minzoom:t.minzoom,buffer:t.buffer,tolerance:t.tolerance,cluster:t.cluster,clusterRadius:t.clusterRadius,clusterMaxZoom:t.clusterMaxZoom}),t.sub=t.updateFeatureData.pipe(e.debounceTime(0)).subscribe(function(){t.MapService.getSource(t.id).setData(t.data)}),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&((t.maxzoom&&!t.maxzoom.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.buffer&&!t.buffer.isFirstChange()||t.tolerance&&!t.tolerance.isFirstChange()||t.cluster&&!t.cluster.isFirstChange()||t.clusterRadius&&!t.clusterRadius.isFirstChange()||t.clusterMaxZoom&&!t.clusterMaxZoom.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit()),t.data&&!t.data.isFirstChange()&&this.MapService.getSource(this.id).setData(this.data))},t.prototype.ngOnDestroy=function(){this.sourceAdded&&(this.sub.unsubscribe(),this.MapService.removeSource(this.id))},t.prototype.addFeature=function(t){this.data.features.push(t),this.updateFeatureData.next()},t.prototype.removeFeature=function(t){var e=this.data,n=e.features.indexOf(t);-1<n&&e.features.splice(n,1),this.updateFeatureData.next()},t.prototype.getNewFeatureId=function(){return++this.featureIdCounter},t}();B.decorators=[{type:r.Component,args:[{selector:"mgl-geojson-source",template:"",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],B.ctorParameters=function(){return[{type:M}]},B.propDecorators={id:[{type:r.Input}],data:[{type:r.Input}],minzoom:[{type:r.Input}],maxzoom:[{type:r.Input}],buffer:[{type:r.Input}],tolerance:[{type:r.Input}],cluster:[{type:r.Input}],clusterRadius:[{type:r.Input}],clusterMaxZoom:[{type:r.Input}]};var V=function(){function t(t){this.GeoJSONSourceComponent=t,this.type="Feature"}return t.prototype.ngOnInit=function(){this.id||(this.id=this.GeoJSONSourceComponent.getNewFeatureId()),this.feature={type:this.type,geometry:this.geometry,properties:this.properties?this.properties:{}},this.feature.id=this.id,this.GeoJSONSourceComponent.addFeature(this.feature)},t.prototype.ngOnDestroy=function(){this.GeoJSONSourceComponent.removeFeature(this.feature)},t.prototype.updateCoordinates=function(t){this.feature.geometry.coordinates=t,this.GeoJSONSourceComponent.updateFeatureData.next()},t}();V.decorators=[{type:r.Component,args:[{selector:"mgl-feature",template:"",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],V.ctorParameters=function(){return[{type:B,decorators:[{type:r.Inject,args:[r.forwardRef(function(){return B})]}]}]},V.propDecorators={id:[{type:r.Input}],geometry:[{type:r.Input}],properties:[{type:r.Input}]};var $=function(){function t(t,e,n,o){this.MapService=t,this.NgZone=e,this.FeatureComponent=n,this.MarkerComponent=o,this.dragStart=new r.EventEmitter,this.dragEnd=new r.EventEmitter,this.drag=new r.EventEmitter,this.destroyed$=new f.ReplaySubject(1)}return t.prototype.ngOnInit=function(){var t,e,n;if(this.MarkerComponent){var o=this.MarkerComponent.content.nativeElement;1===o.children.length&&(o=o.children[0]),t=c.fromEvent(o,"mouseenter"),e=c.fromEvent(o,"mouseleave"),n=this.MarkerComponent.updateCoordinates.bind(this.MarkerComponent)}else{if(!this.FeatureComponent||!this.layer)throw new Error("mglDraggable can only be used on Feature (with a layer as input) or Marker");if(t=this.layer.mouseEnter,e=this.layer.mouseLeave,n=this.FeatureComponent.updateCoordinates.bind(this.FeatureComponent),"Point"!==this.FeatureComponent.geometry.type)throw new Error("mglDraggable only support point feature")}this.handleDraggable(t,e,n)},t.prototype.ngOnDestroy=function(){this.destroyed$.next(undefined),this.destroyed$.complete()},t.prototype.handleDraggable=function(r,i,a){var s=this,u=!1,p=!1;this.MapService.mapCreated$.subscribe(function(){var t=c.fromEvent(s.MapService.mapInstance,"mouseup"),e=r.pipe(d.takeUntil(s.destroyed$),m.filter(function(){return!u}),m.filter(function(t){return s.filterFeature(t)}),y.tap(function(){p=!0,s.MapService.changeCanvasCursor("move"),s.MapService.updateDragPan(!1)}),h.switchMap(function(){return c.fromEvent(s.MapService.mapInstance,"mousedown").pipe(d.takeUntil(i))})),n=e.pipe(h.switchMap(function(){return c.fromEvent(s.MapService.mapInstance,"mousemove").pipe(d.takeUntil(t))})),o=e.pipe(h.switchMap(function(){return t.pipe(l.take(1))}));e.subscribe(function(t){u=!0,s.dragStart.observers.length&&s.NgZone.run(function(){return s.dragStart.emit(t)})}),n.subscribe(function(t){a([t.lngLat.lng,t.lngLat.lat]),s.drag.observers.length&&s.NgZone.run(function(){return s.drag.emit(t)})}),o.subscribe(function(t){u=!1,s.dragEnd.observers.length&&s.NgZone.run(function(){return s.dragEnd.emit(t)}),p||(s.MapService.changeCanvasCursor(""),s.MapService.updateDragPan(!0))}),i.pipe(d.takeUntil(s.destroyed$),y.tap(function(){return p=!1}),m.filter(function(){return!u})).subscribe(function(){s.MapService.changeCanvasCursor(""),s.MapService.updateDragPan(!0)})})},t.prototype.filterFeature=function(t){if(this.FeatureComponent&&this.layer&&!this.MapService.queryRenderedFeatures(t.point,{layers:[this.layer.id],filter:["all",["==","$type","Point"],["==","$id",this.FeatureComponent.id]]})[0])return!1;return!0},t}();$.decorators=[{type:r.Directive,args:[{selector:"[mglDraggable]"}]}],$.ctorParameters=function(){return[{type:M},{type:r.NgZone},{type:V,decorators:[{type:r.Optional},{type:r.Host}]},{type:T,decorators:[{type:r.Optional},{type:r.Host}]}]},$.propDecorators={layer:[{type:r.Input,args:["mglDraggable"]}],dragStart:[{type:r.Output}],dragEnd:[{type:r.Output}],drag:[{type:r.Output}]};var q=function(){function t(t,e){this.MapService=t,this.zone=e,this.error=new r.EventEmitter,this.loaded=new r.EventEmitter,this.imageAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){return C(t,void 0,void 0,function(){var e,n=this;return E(this,function(t){switch(t.label){case 0:return this.data?(this.MapService.addImage(this.id,this.data,this.options),this.imageAdded=!0,[3,5]):[3,1];case 1:if(!this.url)return[3,5];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.MapService.loadAndAddImage(this.id,this.url,this.options)];case 3:return t.sent(),this.imageAdded=!0,this.zone.run(function(){n.loaded.emit()}),[3,5];case 4:return e=t.sent(),this.zone.run(function(){n.error.emit(e)}),[3,5];case 5:return[2]}})})})},t.prototype.ngOnChanges=function(t){(t.data&&!t.data.isFirstChange()||t.options&&!t.options.isFirstChange()||t.url&&!t.url.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.imageAdded&&this.MapService.removeImage(this.id)},t}();q.decorators=[{type:r.Component,args:[{selector:"mgl-image",template:""}]}],q.ctorParameters=function(){return[{type:M},{type:r.NgZone}]},q.propDecorators={id:[{type:r.Input}],data:[{type:r.Input}],options:[{type:r.Input}],url:[{type:r.Input}],error:[{type:r.Output}],loaded:[{type:r.Output}]};var N=function(){function t(t){this.MapService=t,this.movingMethod="flyTo",this.resize=new r.EventEmitter,this.remove=new r.EventEmitter,this.mouseDown=new r.EventEmitter,this.mouseUp=new r.EventEmitter,this.mouseMove=new r.EventEmitter,this.click=new r.EventEmitter,this.dblClick=new r.EventEmitter,this.mouseEnter=new r.EventEmitter,this.mouseLeave=new r.EventEmitter,this.mouseOver=new r.EventEmitter,this.mouseOut=new r.EventEmitter,this.contextMenu=new r.EventEmitter,this.touchStart=new r.EventEmitter,this.touchEnd=new r.EventEmitter,this.touchMove=new r.EventEmitter,this.touchCancel=new r.EventEmitter,this.moveStart=new r.EventEmitter,this.move=new r.EventEmitter,this.moveEnd=new r.EventEmitter,this.dragStart=new r.EventEmitter,this.drag=new r.EventEmitter,this.dragEnd=new r.EventEmitter,this.zoomStart=new r.EventEmitter,this.zoomEvt=new r.EventEmitter,this.zoomEnd=new r.EventEmitter,this.rotateStart=new r.EventEmitter,this.rotate=new r.EventEmitter,this.rotateEnd=new r.EventEmitter,this.pitchStart=new r.EventEmitter,this.pitchEvt=new r.EventEmitter,this.pitchEnd=new r.EventEmitter,this.boxZoomStart=new r.EventEmitter,this.boxZoomEnd=new r.EventEmitter,this.boxZoomCancel=new r.EventEmitter,this.webGlContextLost=new r.EventEmitter,this.webGlContextRestored=new r.EventEmitter,this.load=new r.EventEmitter,this.render=new r.EventEmitter,this.error=new r.EventEmitter,this.data=new r.EventEmitter,this.styleData=new r.EventEmitter,this.sourceData=new r.EventEmitter,this.dataLoading=new r.EventEmitter,this.styleDataLoading=new r.EventEmitter,this.sourceDataLoading=new r.EventEmitter}return Object.defineProperty(t.prototype,"mapInstance",{get:function(){return this.MapService.mapInstance},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){this.MapService.setup({accessToken:this.accessToken,customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{container:this.mapContainer.nativeElement,minZoom:this.minZoom,maxZoom:this.maxZoom,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,classes:this.classes,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest},mapEvents:this}),this.cursorStyle&&this.MapService.changeCanvasCursor(this.cursorStyle)},t.prototype.ngOnDestroy=function(){this.MapService.destroyMap()},t.prototype.ngOnChanges=function(e){return C(this,void 0,void 0,function(){return E(this,function(t){switch(t.label){case 0:return[4,this.MapService.mapCreated$.toPromise()];case 1:return t.sent(),e.cursorStyle&&!e.cursorStyle.isFirstChange()&&this.MapService.changeCanvasCursor(e.cursorStyle.currentValue),e.minZoom&&!e.minZoom.isFirstChange()&&this.MapService.updateMinZoom(e.minZoom.currentValue),e.maxZoom&&!e.maxZoom.isFirstChange()&&this.MapService.updateMaxZoom(e.maxZoom.currentValue),e.scrollZoom&&!e.scrollZoom.isFirstChange()&&this.MapService.updateScrollZoom(e.scrollZoom.currentValue),e.dragRotate&&!e.dragRotate.isFirstChange()&&this.MapService.updateDragRotate(e.dragRotate.currentValue),e.touchZoomRotate&&!e.touchZoomRotate.isFirstChange()&&this.MapService.updateTouchZoomRotate(e.touchZoomRotate.currentValue),e.doubleClickZoom&&!e.doubleClickZoom.isFirstChange()&&this.MapService.updateDoubleClickZoom(e.doubleClickZoom.currentValue),e.keyboard&&!e.keyboard.isFirstChange()&&this.MapService.updateKeyboard(e.keyboard.currentValue),e.dragPan&&!e.dragPan.isFirstChange()&&this.MapService.updateDragPan(e.dragPan.currentValue),e.boxZoom&&!e.boxZoom.isFirstChange()&&this.MapService.updateBoxZoom(e.boxZoom.currentValue),e.style&&!e.style.isFirstChange()&&this.MapService.updateStyle(e.style.currentValue),e.maxBounds&&!e.maxBounds.isFirstChange()&&this.MapService.updateMaxBounds(e.maxBounds.currentValue),e.fitBounds&&!e.fitBounds.isFirstChange()&&this.MapService.fitBounds(e.fitBounds.currentValue,this.fitBoundsOptions),!this.centerWithPanTo||!e.center||e.center.isFirstChange()||e.zoom||e.bearing||e.pitch?(e.center&&!e.center.isFirstChange()||e.zoom&&!e.zoom.isFirstChange()||e.bearing&&!e.bearing.isFirstChange()||e.pitch&&!e.pitch.isFirstChange())&&this.MapService.move(this.movingMethod,this.movingOptions,e.zoom&&this.zoom?this.zoom[0]:undefined,e.center?this.center:undefined,e.bearing&&this.bearing?this.bearing[0]:undefined,e.pitch&&this.pitch?this.pitch[0]:undefined):this.MapService.panTo(this.center,this.panToOptions),[2]}})})},t}();N.decorators=[{type:r.Component,args:[{selector:"mgl-map",template:"<div #container></div>",styles:["\n  :host {\n    display: block;\n  }\n  div {\n    height: 100%;\n    width: 100%;\n  }\n  "],providers:[M],changeDetection:r.ChangeDetectionStrategy.OnPush}]}],N.ctorParameters=function(){return[{type:M}]},N.propDecorators={accessToken:[{type:r.Input}],customMapboxApiUrl:[{type:r.Input}],hash:[{type:r.Input}],refreshExpiredTiles:[{type:r.Input}],failIfMajorPerformanceCaveat:[{type:r.Input}],classes:[{type:r.Input}],bearingSnap:[{type:r.Input}],interactive:[{type:r.Input}],pitchWithRotate:[{type:r.Input}],attributionControl:[{type:r.Input}],logoPosition:[{type:r.Input}],maxTileCacheSize:[{type:r.Input}],localIdeographFontFamily:[{type:r.Input}],preserveDrawingBuffer:[{type:r.Input}],renderWorldCopies:[{type:r.Input}],trackResize:[{type:r.Input}],transformRequest:[{type:r.Input}],minZoom:[{type:r.Input}],maxZoom:[{type:r.Input}],scrollZoom:[{type:r.Input}],dragRotate:[{type:r.Input}],touchZoomRotate:[{type:r.Input}],doubleClickZoom:[{type:r.Input}],keyboard:[{type:r.Input}],dragPan:[{type:r.Input}],boxZoom:[{type:r.Input}],style:[{type:r.Input}],center:[{type:r.Input}],maxBounds:[{type:r.Input}],zoom:[{type:r.Input}],bearing:[{type:r.Input}],pitch:[{type:r.Input}],movingMethod:[{type:r.Input}],movingOptions:[{type:r.Input}],fitBounds:[{type:r.Input}],fitBoundsOptions:[{type:r.Input}],centerWithPanTo:[{type:r.Input}],panToOptions:[{type:r.Input}],cursorStyle:[{type:r.Input}],resize:[{type:r.Output}],remove:[{type:r.Output}],mouseDown:[{type:r.Output}],mouseUp:[{type:r.Output}],mouseMove:[{type:r.Output}],click:[{type:r.Output}],dblClick:[{type:r.Output}],mouseEnter:[{type:r.Output}],mouseLeave:[{type:r.Output}],mouseOver:[{type:r.Output}],mouseOut:[{type:r.Output}],contextMenu:[{type:r.Output}],touchStart:[{type:r.Output}],touchEnd:[{type:r.Output}],touchMove:[{type:r.Output}],touchCancel:[{type:r.Output}],moveStart:[{type:r.Output}],move:[{type:r.Output}],moveEnd:[{type:r.Output}],dragStart:[{type:r.Output}],drag:[{type:r.Output}],dragEnd:[{type:r.Output}],zoomStart:[{type:r.Output}],zoomEvt:[{type:r.Output}],zoomEnd:[{type:r.Output}],rotateStart:[{type:r.Output}],rotate:[{type:r.Output}],rotateEnd:[{type:r.Output}],pitchStart:[{type:r.Output}],pitchEvt:[{type:r.Output}],pitchEnd:[{type:r.Output}],boxZoomStart:[{type:r.Output}],boxZoomEnd:[{type:r.Output}],boxZoomCancel:[{type:r.Output}],webGlContextLost:[{type:r.Output}],webGlContextRestored:[{type:r.Output}],load:[{type:r.Output}],render:[{type:r.Output}],error:[{type:r.Output}],data:[{type:r.Output}],styleData:[{type:r.Output}],sourceData:[{type:r.Output}],dataLoading:[{type:r.Output}],styleDataLoading:[{type:r.Output}],sourceDataLoading:[{type:r.Output}],mapContainer:[{type:r.ViewChild,args:["container"]}]};var G=function(){};G.decorators=[{type:r.Directive,args:[{selector:"ng-template[mglPoint]"}]}];var U=function(){};U.decorators=[{type:r.Directive,args:[{selector:"ng-template[mglClusterPoint]"}]}];var _=function(){function t(t,e){var o=this;this.MapService=t,this.ChangeDetectorRef=e,this.sub=new a.Subscription,this.getLeavesFn=function(n){return function(t,e){return o.supercluster.getLeaves(n.properties.cluster_id,t,e)}},this.getChildrenFn=function(t){return function(){return o.supercluster.getChildren(t.properties.cluster_id)}},this.getClusterExpansionZoomFn=function(t){return function(){return o.supercluster.getClusterExpansionZoom(t.properties.cluster_id)}}}return t.prototype.ngOnInit=function(){var n={radius:this.radius,maxZoom:this.maxZoom,minZoom:this.minZoom,extent:this.extent,nodeSize:this.nodeSize,log:this.log,reduce:this.reduce,initial:this.initial,map:this.map};Object.keys(n).forEach(function(t){var e=t;n[e]===undefined&&delete n[e]}),this.supercluster=b(n),this.supercluster.load(this.data.features)},t.prototype.ngOnChanges=function(t){t.data&&!t.data.isFirstChange()&&this.supercluster.load(this.data.features)},t.prototype.ngAfterContentInit=function(){var e=this;this.MapService.mapCreated$.subscribe(function(){var t=g.merge(c.fromEvent(e.MapService.mapInstance,"zoomChange"),c.fromEvent(e.MapService.mapInstance,"move")).pipe(v.startWith(undefined)).subscribe(function(){return e.updateCluster()});e.sub.add(t)})},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe()},t.prototype.updateCluster=function(){var t=this.MapService.getCurrentViewportBbox(),e=Math.round(this.MapService.mapInstance.getZoom());this.clusterPoints=this.supercluster.getClusters(t,e),this.ChangeDetectorRef.detectChanges(),this.MapService.applyChanges()},t}();_.decorators=[{type:r.Component,args:[{selector:"mgl-marker-cluster",template:'\n    <ng-container *ngFor="let feature of clusterPoints">\n      <ng-container *ngIf="feature.properties.cluster; else point">\n        <mgl-marker\n          [feature]="feature"\n        >\n          <ng-container *ngTemplateOutlet="clusterPointTpl; context: {\n            $implicit: feature,\n            getLeavesFn: getLeavesFn(feature),\n            getChildrenFn: getChildrenFn(feature),\n            getClusterExpansionZoomFn: getClusterExpansionZoomFn(feature)\n          }"></ng-container>\n        </mgl-marker>\n      </ng-container>\n      <ng-template #point>\n        <mgl-marker\n          [feature]="feature"\n        >\n          <ng-container *ngTemplateOutlet="pointTpl; context: { $implicit: feature }"></ng-container>\n        </mgl-marker>\n      </ng-template>\n    </ng-container>\n  ',changeDetection:r.ChangeDetectionStrategy.OnPush,preserveWhitespaces:!1}]}],_.ctorParameters=function(){return[{type:M},{type:r.ChangeDetectorRef}]},_.propDecorators={radius:[{type:r.Input}],maxZoom:[{type:r.Input}],minZoom:[{type:r.Input}],extent:[{type:r.Input}],nodeSize:[{type:r.Input}],log:[{type:r.Input}],reduce:[{type:r.Input}],initial:[{type:r.Input}],map:[{type:r.Input}],data:[{type:r.Input}],pointTpl:[{type:r.ContentChild,args:[G,{read:r.TemplateRef}]}],clusterPointTpl:[{type:r.ContentChild,args:[U,{read:r.TemplateRef}]}]};var W=function(){function t(t){this.MapService=t,this.close=new r.EventEmitter}return t.prototype.ngOnInit=function(){if(this.lngLat&&this.marker)throw new Error("marker and lngLat input are mutually exclusive")},t.prototype.ngOnChanges=function(t){if(t.lngLat&&!t.lngLat.isFirstChange()){this.MapService.removePopup(this.popupInstance);var e=this.createPopup();this.MapService.addPopup(e),this.popupInstance=e}if(t.marker&&!t.marker.isFirstChange()){var n=t.marker.previousValue;n.markerInstance&&n.markerInstance.setPopup(undefined),this.marker&&this.marker.markerInstance&&this.marker.markerInstance.setPopup(this.popupInstance)}},t.prototype.ngAfterViewInit=function(){this.popupInstance=this.createPopup()},t.prototype.ngOnDestroy=function(){this.MapService.removePopup(this.popupInstance),this.popupInstance=undefined},t.prototype.createPopup=function(){var t=this,e={closeButton:this.closeButton,closeOnClick:this.closeOnClick,anchor:this.anchor,offset:this.offset};Object.keys(e).forEach(function(t){return e[t]===undefined&&delete e[t]});var n=new i.Popup(e);return n.once("close",function(){t.close.emit()}),n.setDOMContent(this.content.nativeElement),this.MapService.mapCreated$.subscribe(function(){t.lngLat?(n.setLngLat(t.lngLat),t.MapService.addPopup(n)):t.marker&&t.marker.markerInstance&&t.marker.markerInstance.setPopup(n)}),n},t}();W.decorators=[{type:r.Component,args:[{selector:"mgl-popup",template:"<div #content><ng-content></ng-content></div>",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],W.ctorParameters=function(){return[{type:M}]},W.propDecorators={closeButton:[{type:r.Input}],closeOnClick:[{type:r.Input}],anchor:[{type:r.Input}],offset:[{type:r.Input}],lngLat:[{type:r.Input}],marker:[{type:r.Input}],close:[{type:r.Output}],content:[{type:r.ViewChild,args:["content"]}]};var K=function(){function t(t){this.MapService=t,this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var e=this;this.MapService.mapLoaded$.subscribe(function(){var t={type:"canvas",coordinates:e.coordinates,canvas:e.canvas,animate:e.animate};e.MapService.addSource(e.id,t),e.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.coordinates&&!t.coordinates.isFirstChange()||t.canvas&&!t.canvas.isFirstChange()||t.animate&&!t.animate.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();K.decorators=[{type:r.Component,args:[{selector:"mgl-canvas-source",template:"",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],K.ctorParameters=function(){return[{type:M}]},K.propDecorators={id:[{type:r.Input}],coordinates:[{type:r.Input}],canvas:[{type:r.Input}],animate:[{type:r.Input}]};var H=function(){function t(t){this.MapService=t,this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){t.MapService.addSource(t.id,{type:"image",url:t.url,coordinates:t.coordinates}),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.url&&!t.url.isFirstChange()||t.coordinates&&!t.coordinates.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();H.decorators=[{type:r.Component,args:[{selector:"mgl-image-source",template:"",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],H.ctorParameters=function(){return[{type:M}]},H.propDecorators={id:[{type:r.Input}],url:[{type:r.Input}],coordinates:[{type:r.Input}]};var J=function(){function t(t){this.MapService=t,this.type="raster",this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var e=this;this.MapService.mapLoaded$.subscribe(function(){var t={type:e.type,url:e.url,tiles:e.tiles,bounds:e.bounds,minzoom:e.minzoom,maxzoom:e.maxzoom,tileSize:e.tileSize};e.MapService.addSource(e.id,t),e.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.url&&!t.url.isFirstChange()||t.tiles&&!t.tiles.isFirstChange()||t.bounds&&!t.bounds.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange()||t.tileSize&&!t.tileSize.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();J.decorators=[{type:r.Component,args:[{selector:"mgl-raster-source",template:"",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],J.ctorParameters=function(){return[{type:M}]},J.propDecorators={id:[{type:r.Input}],url:[{type:r.Input}],tiles:[{type:r.Input}],bounds:[{type:r.Input}],minzoom:[{type:r.Input}],maxzoom:[{type:r.Input}],tileSize:[{type:r.Input}]};var X=function(){function t(t){this.MapService=t,this.type="vector",this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){t.MapService.addSource(t.id,{type:t.type,url:t.url,tiles:t.tiles,minzoom:t.minzoom,maxzoom:t.maxzoom}),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.url&&!t.url.isFirstChange()||t.tiles&&!t.tiles.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();X.decorators=[{type:r.Component,args:[{selector:"mgl-vector-source",template:"",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],X.ctorParameters=function(){return[{type:M}]},X.propDecorators={id:[{type:r.Input}],url:[{type:r.Input}],tiles:[{type:r.Input}],minzoom:[{type:r.Input}],maxzoom:[{type:r.Input}]};var Y=function(){function t(t){this.MapService=t,this.sourceAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.MapService.mapLoaded$.subscribe(function(){t.MapService.addSource(t.id,{type:"video",urls:t.urls,coordinates:t.coordinates}),t.sourceAdded=!0})},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.urls&&!t.urls.isFirstChange()||t.coordinates&&!t.coordinates.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sourceAdded&&this.MapService.removeSource(this.id)},t}();Y.decorators=[{type:r.Component,args:[{selector:"mgl-video-source",template:"",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],Y.ctorParameters=function(){return[{type:M}]},Y.propDecorators={id:[{type:r.Input}],urls:[{type:r.Input}],coordinates:[{type:r.Input}]};var Q=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:S,useValue:t.accessToken},{provide:P,useValue:t.geocoderAccessToken||t.accessToken}]}},e}();Q.decorators=[{type:r.NgModule,args:[{imports:[I.CommonModule],declarations:[N,j,$,q,X,B,J,H,Y,K,V,T,W,w,D,Z,L,F,k,R,G,U,_],exports:[N,j,$,q,X,B,J,H,Y,K,V,T,W,w,D,Z,L,F,k,R,G,U,_]}]}],t.NgxMapboxGLModule=Q,t.MAPBOX_API_KEY=S,t.MglResizeEventEmitter=x,t.MapService=M,t.MapComponent=N,t.ɵs=k,t.ɵm=w,t.ɵn=D,t.ɵq=L,t.ɵp=P,t.ɵr=F,t.ɵo=Z,t.ɵt=R,t.ɵb=$,t.ɵf=q,t.ɵa=j,t.ɵv=U,t.ɵw=_,t.ɵu=G,t.ɵe=T,t.ɵl=W,t.ɵk=K,t.ɵc=V,t.ɵd=B,t.ɵi=H,t.ɵh=J,t.ɵg=X,t.ɵj=Y,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-mapbox-gl.umd.min.js.map
